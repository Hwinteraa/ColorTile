<!DOCTYPE html>
<html lang="kr">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recipe: Drawing a square</title>
    <link rel="stylesheet" href="../style.css">
    <style></style>

    <!-- header -->
    <header>
        <div class="container">
            <h1>
                <button onclick="window.location.href='../index.html';">GC</button>
            </h1>
        </div>
    </header>
    <!-- //end header -->

    <!-- PortFolio -->
    <section id="portfolio" class="portfolio">
        <div class="container">
            <div class="title">
                <h4>2022100290</h4>
            </div>
            <div class="portfolio-me">
                    <!--<img src="mock1.png">-->


                    <script src="easel.js"></script>
                    <script type="text/javascript">
                        var canvas;
                        var stage;
                        var squareSide = 70;
                        var squareOutline = 5;
                        var max_rgb_color_value = 255;
                        var gray = Graphics.getRGB(20, 20, 20);
                        var placementArray = [];
                        //var highlight = Graphics.getRGB(255, 255, 0);
                        var tileClicked;
                        var timeAllowable;
                        var totalMatchesPossible;
                        var matchesFound;
                        var txt;
                        var matchesFoundText;
                        var squares;

                        function init() {
                            var rows = 5;
                            var columns = 6;
                            var squarePadding = 10;

                            canvas = document.getElementById('myCanvas');
                            stage = new Stage(canvas);
                            //var square = drawSquare();
                            //stage.addChild(square);
                            //stage.update();

                            var numberOfTiles = rows * columns;
                            matchesFound = 0;
                            timeAllowable = 100;
                            txt = new Text(timeAllowable, "30px Monospace", "#000");
                            txt.textBaseline = "top";
                            txt.x = 500;
                            txt.y = 0;
                            stage.addChild(txt);
                            squares = [];
                            totalMatchesPossible = numberOfTiles / 2;
                            matchesFoundText = new Text("Pairs Found:" + matchesFound + "/" + totalMatchesPossible, "30px Monospace", "#000");
                            matchesFoundText.textBaseline = "top";
                            matchesFoundText.x = 500;
                            matchesFoundText.y = 40;
                            stage.addChild(matchesFoundText);
                            Ticker.init();
                            Ticker.addListener(window);
                            Ticker.setPaused(false);
                            setPlacementArray(numberOfTiles);

                            for (var i = 0; i < numberOfTiles; i++) {
                                var placement = getRandomPlacement(placementArray);
                                if (i % 2 === 0) {
                                    var color = randomColor();
                                }
                                //var square = drawSquare(color);
                                var square = drawSquare(gray);
                                square.color = color;
                                square.x = (squareSide + squarePadding) * (placement % columns);
                                square.y = (squareSide + squarePadding) * Math.floor(placement / columns);
                                squares.push(square);
                                stage.addChild(square);
                                square.onPress = handleOnPress;
                                stage.update();
                            };
                        }

                        function drawSquare(color) {
                            var shape = new Shape();
                            var graphics = shape.graphics;
                            //  var color = randomColor();
                            graphics.setStrokeStyle(squareOutline);
                            graphics.beginStroke(gray);
                            graphics.beginFill(color);
                            graphics.rect(squareOutline, squareOutline, squareSide, squareSide);
                            return shape;
                        }

                        function randomColor() {
                            var color = Math.floor(Math.random() * max_rgb_color_value);
                            var color2 = Math.floor(Math.random() * max_rgb_color_value);
                            var color3 = Math.floor(Math.random() * max_rgb_color_value);
                            return Graphics.getRGB(color, color2, color3)
                        }

                        function setPlacementArray(numberOfTiles) {
                            for (var i = 0; i < numberOfTiles; i++) {
                                placementArray.push(i);
                            }
                        }

                        function getRandomPlacement(placementArray) {
                            randomNumber = Math.floor(Math.random() * placementArray.length);
                            return placementArray.splice(randomNumber, 1)[0];
                        }

                        function handleOnPress(event) {
                            var tile = event.target;
                            tile.graphics.beginFill(tile.color)
                                .rect(squareOutline, squareOutline, squareSide, squareSide);
                            if (!!tileClicked === false || tileClicked === tile) {
                                tileClicked = tile;
                            }
                            else {
                                if (tileClicked.color === tile.color && tileClicked !== tile) {
                                    tileClicked.visible = false;
                                    tile.visible = false;

                                    matchesFound++;
                                    matchesFoundText.text = "Pairs Found: " + matchesFound + "/" + totalMatchesPossible;
                                    if (matchesFound === totalMatchesPossible) {
                                        gameOver(true);
                                    }
                                }
                                else {
                                    tileClicked.graphics.beginFill(gray)
                                        .rect(squareOutline, squareOutline, squareSide, squareSide);
                                }
                                tileClicked = tile;
                            }
                            stage.update();
                        }

                        function tick() {
                            secondsLeft = Math.floor((timeAllowable - Ticker.getTime() / 1000));
                            txt.text = secondsLeft;
                            if (secondsLeft <= 0) {
                                gameOver(false);
                            }
                            stage.update();
                        }

                        function gameOver(win) {
                            Ticker.setPaused(true);
                            for (var i = 0; i < squares.length; i++) {
                                squares[i].graphics.beginFill(squares[i].color).rect(5, 5, 70, 70);
                                squares[i].onPress = null;
                            }
                            var replayParagraph = document.getElementById("replay");
                            replayParagraph.innerHTML =
                                "<a href='#' onclick='replay();'>Play Again?</a>";
                            if (win === true) {
                                matchesFoundText.text = "You win!"
                            }
                            else {
                                txt.text = secondsLeft + "... Game Over";
                            }
                        }

                        function replay() {
                            var replayParagraph = document.getElementById(" ");
                            replayParagraph.innerHTML =
                                init();
                        }
                    </script>

                </div>
            </div>
        </div>
    </section>
    <!-- //end PortFolio -->


</head>

<body onload="init()">
    <header id="header" class="EaselJS">
        <p id="replay"></p>
    </header>
    <canvas id="myCanvas" width="960" height="400"></canvas>
</body>

</html>
